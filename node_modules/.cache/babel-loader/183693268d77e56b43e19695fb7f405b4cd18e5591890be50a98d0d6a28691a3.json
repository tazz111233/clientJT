{"ast":null,"code":"import React,{useState}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import\"../styles/Checkout.css\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Checkout(){const location=useLocation();const navigate=useNavigate();const[address,setAddress]=useState(\"\");const[phone,setPhone]=useState(\"\");const[bkash,setBkash]=useState(\"\");// New state for transaction ID\nconst[showPopup,setShowPopup]=useState(false);// State to control popup visibility\nconst storedCart=localStorage.getItem(\"checkoutCart\");const cartItems=location.state||(storedCart?JSON.parse(storedCart):[]);// Calculate total price\nconst totalPrice=cartItems.reduce((total,item)=>{const price=parseFloat(item.price);return isNaN(price)?total:total+price;},0);// Get discount details\nconst discountCode=localStorage.getItem(\"discountCode\");const discountedPrice=parseFloat(localStorage.getItem(\"discountedPrice\"))||totalPrice;// Check if user is logged in\nconst isLoggedIn=localStorage.getItem(\"username\");// Function to handle payment after transaction ID is entered\nconst handlePayment=()=>{console.log(\"Transaction ID Before Sending:\",bkash);if(!bkash){alert(\"Please enter a transaction ID.\");return;}const paymentData={cartItems,discountCode,discountedPrice,usernamep:isLoggedIn,// Sending username as \"usernamep\"\naddress,phone,bkash// Adding transaction ID\n};console.log(\"Final Request Body:\",paymentData);// Send a request to increment views for each product in the cart\ncartItems.forEach(item=>{axios.post(\"https://backendjt-1.onrender.com/incrementProductViews\",{productName:item.name}).then(response=>{console.log(\"Incremented views for \".concat(item.name,\":\"),response.data);}).catch(error=>{console.error(\"Error incrementing views for \".concat(item.name,\":\"),error);});});// Proceed with saving the cart data after incrementing views\naxios.post(\"https://backendjt-1.onrender.com/save-cart\",paymentData).then(response=>{console.log(\"Server Response:\",response.data);// Clear localStorage after successful payment\nlocalStorage.removeItem(\"cart\");localStorage.removeItem(\"checkoutCart\");localStorage.removeItem(\"discountCode\");localStorage.removeItem(\"discountedPrice\");// Redirect to home\nnavigate(\"/home\");}).catch(error=>{console.error(\"Error saving cart:\",error);});setShowPopup(false);// Close the popup\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"gills\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container1\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Checkout\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"carttable\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-table-header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Item\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Price\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-table-body\",children:cartItems.length>0?cartItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"cart-table-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:item.name}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",item.price]})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Your cart is empty!\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"discount-code1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Address\",value:address,onChange:e=>setAddress(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Phone\",value:phone,onChange:e=>setPhone(e.target.value)})]}),cartItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Total: $\",totalPrice.toFixed(2)]}),discountCode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[\"Discount Code Applied: \",discountCode]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Discounted Total: $\",discountedPrice.toFixed(2)]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"pay-button\",onClick:()=>setShowPopup(true),children:\"Place Order\"})]})]})}),showPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"popup-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Enter Transaction ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Transaction ID\",value:bkash,onChange:e=>{setBkash(e.target.value);console.log(bkash);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPopup(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePayment,children:\"Pay\"})]})]})})]});}export default Checkout;","map":{"version":3,"names":["React","useState","useLocation","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Checkout","location","navigate","address","setAddress","phone","setPhone","bkash","setBkash","showPopup","setShowPopup","storedCart","localStorage","getItem","cartItems","state","JSON","parse","totalPrice","reduce","total","item","price","parseFloat","isNaN","discountCode","discountedPrice","isLoggedIn","handlePayment","console","log","alert","paymentData","usernamep","forEach","post","productName","name","then","response","concat","data","catch","error","removeItem","children","className","length","map","index","type","placeholder","value","onChange","e","target","toFixed","onClick"],"sources":["/Users/tasneemmahmud/Desktop/clientJT/src/components/Checkout.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport \"../styles/Checkout.css\";\nimport axios from \"axios\";\n\nfunction Checkout() {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const [address, setAddress] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [bkash, setBkash] = useState(\"\"); // New state for transaction ID\n  const [showPopup, setShowPopup] = useState(false); // State to control popup visibility\n\n  const storedCart = localStorage.getItem(\"checkoutCart\");\n  const cartItems = location.state || (storedCart ? JSON.parse(storedCart) : []);\n\n  // Calculate total price\n  const totalPrice = cartItems.reduce((total, item) => {\n    const price = parseFloat(item.price);\n    return isNaN(price) ? total : total + price;\n  }, 0);\n\n  // Get discount details\n  const discountCode = localStorage.getItem(\"discountCode\");\n  const discountedPrice =\n    parseFloat(localStorage.getItem(\"discountedPrice\")) || totalPrice;\n\n  // Check if user is logged in\n  const isLoggedIn = localStorage.getItem(\"username\");\n\n  // Function to handle payment after transaction ID is entered\n  const handlePayment = () => {\n    console.log(\"Transaction ID Before Sending:\", bkash);\n  \n    if (!bkash) {\n      alert(\"Please enter a transaction ID.\");\n      return;\n    }\n  \n    const paymentData = {\n      cartItems,\n      discountCode,\n      discountedPrice,\n      usernamep: isLoggedIn, // Sending username as \"usernamep\"\n      address,\n      phone,\n      bkash, // Adding transaction ID\n    };\n  \n    console.log(\"Final Request Body:\", paymentData);\n  \n    // Send a request to increment views for each product in the cart\n    cartItems.forEach((item) => {\n      axios\n        .post(\"https://backendjt-1.onrender.com/incrementProductViews\", {\n          productName: item.name,\n        })\n        .then((response) => {\n          console.log(`Incremented views for ${item.name}:`, response.data);\n        })\n        .catch((error) => {\n          console.error(`Error incrementing views for ${item.name}:`, error);\n        });\n    });\n  \n    // Proceed with saving the cart data after incrementing views\n    axios\n      .post(\"https://backendjt-1.onrender.com/save-cart\", paymentData)\n      .then((response) => {\n        console.log(\"Server Response:\", response.data);\n  \n        // Clear localStorage after successful payment\n        localStorage.removeItem(\"cart\");\n        localStorage.removeItem(\"checkoutCart\");\n        localStorage.removeItem(\"discountCode\");\n        localStorage.removeItem(\"discountedPrice\");\n  \n        // Redirect to home\n        navigate(\"/home\");\n      })\n      .catch((error) => {\n        console.error(\"Error saving cart:\", error);\n      });\n  \n    setShowPopup(false); // Close the popup\n  };\n  \n\n  return (\n    <>\n    <div className=\"gills\">\n      <div className=\"container1\">\n        <h1>Checkout</h1>\n        <div className=\"cart\">\n          <div className=\"carttable\">\n            <div className=\"cart-table-header\">\n              <span>Item</span>\n              <span>Price</span>\n            </div>\n            <div className=\"cart-table-body\">\n              {cartItems.length > 0 ? (\n                cartItems.map((item, index) => (\n                  <div key={index} className=\"cart-table-row\">\n                    <span>{item.name}</span>\n                    <span>${item.price}</span>\n                  </div>\n                ))\n              ) : (\n                <p>Your cart is empty!</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"discount-code1\">\n            <input\n              type=\"text\"\n              placeholder=\"Enter Address\"\n              value={address}\n              onChange={(e) => setAddress(e.target.value)}\n            />\n            <input\n              type=\"text\"\n              placeholder=\"Enter Phone\"\n              value={phone}\n              onChange={(e) => setPhone(e.target.value)}\n            />\n          </div>\n\n          {cartItems.length > 0 && (\n            <div className=\"total\">\n              <h4>Total: ${totalPrice.toFixed(2)}</h4>\n              {discountCode && (\n                <>\n                  <h5>Discount Code Applied: {discountCode}</h5>\n                  <h4>Discounted Total: ${discountedPrice.toFixed(2)}</h4>\n                </>\n              )}\n            </div>\n          )}\n\n          {/* Place Order Button - Opens Popup */}\n          <button className=\"pay-button\" onClick={() => setShowPopup(true)}>\n            Place Order\n          </button>\n        </div>\n      </div>\n      </div>\n\n      {/* Transaction ID Popup */}\n      {showPopup && (\n        <div className=\"popup-overlay\">\n          <div className=\"popup\">\n            <h2>Enter Transaction ID</h2>\n            <input\n              type=\"text\"\n              placeholder=\"Transaction ID\"\n              value={bkash}\n              onChange={(e) => {setBkash(e.target.value);\n                console.log(bkash)}\n              }\n            />\n            <div className=\"popup-buttons\">\n              <button onClick={() => setShowPopup(false)}>Cancel</button>\n              <button onClick={handlePayment}>Pay</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default Checkout;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}