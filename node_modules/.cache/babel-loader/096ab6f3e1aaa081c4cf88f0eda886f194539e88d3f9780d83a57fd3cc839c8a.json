{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate,useLocation}from\"react-router-dom\";import ProductCard from\"../components/ProductCard\";import\"../styles/Shop.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Shop(){const[items,setItems]=useState([]);const[filteredItems,setFilteredItems]=useState([]);const[sortOrder,setSortOrder]=useState(\"\");const[categories,setCategories]=useState([]);const[selectedCategory,setSelectedCategory]=useState(\"\");const[isSortOpen,setIsSortOpen]=useState(false);const[isCategoryOpen,setIsCategoryOpen]=useState(false);const navigate=useNavigate();const location=useLocation();useEffect(()=>{const fetchProducts=async()=>{try{const response=await fetch(\"https://backendjt-1.onrender.com/getAllProducts\");if(!response.ok){throw new Error(\"Failed to fetch products\");}const data=await response.json();console.log(\"ðŸ“¦ Full API Response:\",data);// Debug full response\nsetItems(data);setFilteredItems(data);const uniqueCategories=[...new Set(data.map(item=>item.category))];setCategories(uniqueCategories);}catch(error){console.error(\"Error fetching products:\",error);}};fetchProducts();},[]);useEffect(()=>{const queryParams=new URLSearchParams(location.search);const categoryFromUrl=queryParams.get(\"category\");if(categoryFromUrl){setSelectedCategory(categoryFromUrl);setFilteredItems(items.filter(item=>item.category===categoryFromUrl));}},[location.search,items]);const handleSortChange=order=>{setSortOrder(order);setIsSortOpen(false);// Always reset to all products before sorting\nlet sortedItems=[...items];if(order===\"all\"){setFilteredItems(sortedItems);// Reset to all products\nreturn;}if(order===\"lowToHigh\"){sortedItems.sort((a,b)=>a.price-b.price);}else if(order===\"highToLow\"){sortedItems.sort((a,b)=>b.price-a.price);}else if(order===\"top5\"){sortedItems=[...items].filter(item=>item.number!==undefined).sort((a,b)=>(b.number||0)-(a.number||0)).slice(0,5);}setFilteredItems(sortedItems);};useEffect(()=>{if(sortOrder===\"top5\"){handleSortChange(\"top5\");}},[items,sortOrder,handleSortChange]);const handleCategoryChange=category=>{setSelectedCategory(category);setIsCategoryOpen(false);setFilteredItems(category?items.filter(item=>item.category===category):items);navigate(\"/shop?category=\".concat(category));};const handleCartClick=()=>{const cartItems=JSON.parse(localStorage.getItem(\"cart\"))||[];if(cartItems.length>0){navigate(\"/cart\");}else{alert(\"Your cart is empty!\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"shop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"custom-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-button\",onClick:()=>setIsSortOpen(!isSortOpen),children:sortOrder?sortOrder===\"lowToHigh\"?\"Low to High\":sortOrder===\"highToLow\"?\"High to Low\":sortOrder===\"top5\"?\"Top 5 Ordered\":\"All Products\":\"Sort by\"}),isSortOpen&&/*#__PURE__*/_jsxs(\"ul\",{className:\"dropdown-menu\",children:[/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleSortChange(\"all\"),children:\"All Products\"}),/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleSortChange(\"lowToHigh\"),children:\"Low to High\"}),/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleSortChange(\"highToLow\"),children:\"High to Low\"}),/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleSortChange(\"top5\"),children:\"Top 5 Ordered\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-button\",onClick:()=>setIsCategoryOpen(!isCategoryOpen),children:selectedCategory||\"Filter by Category\"}),isCategoryOpen&&/*#__PURE__*/_jsxs(\"ul\",{className:\"dropdown-menu\",children:[/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleCategoryChange(\"\"),children:\"All\"}),categories.map(category=>/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleCategoryChange(category),children:category},category))]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"product-grid\",children:filteredItems.length>0?filteredItems.map(item=>/*#__PURE__*/_jsx(ProductCard,{product:item},item.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No products found\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"hiddenDiv\",onClick:handleCartClick,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart\"})})]});}export default Shop;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useLocation","ProductCard","jsx","_jsx","jsxs","_jsxs","Shop","items","setItems","filteredItems","setFilteredItems","sortOrder","setSortOrder","categories","setCategories","selectedCategory","setSelectedCategory","isSortOpen","setIsSortOpen","isCategoryOpen","setIsCategoryOpen","navigate","location","fetchProducts","response","fetch","ok","Error","data","json","console","log","uniqueCategories","Set","map","item","category","error","queryParams","URLSearchParams","search","categoryFromUrl","get","filter","handleSortChange","order","sortedItems","sort","a","b","price","number","undefined","slice","handleCategoryChange","concat","handleCartClick","cartItems","JSON","parse","localStorage","getItem","length","alert","className","children","onClick","product","id"],"sources":["/Users/tasneemmahmud/Desktop/clientJT/src/pages/Shop.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport ProductCard from \"../components/ProductCard\";\nimport \"../styles/Shop.css\";\n\nfunction Shop() {\n  const [items, setItems] = useState([]);\n  const [filteredItems, setFilteredItems] = useState([]);\n  const [sortOrder, setSortOrder] = useState(\"\");\n  const [categories, setCategories] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\n  const [isSortOpen, setIsSortOpen] = useState(false);\n  const [isCategoryOpen, setIsCategoryOpen] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      try {\n        const response = await fetch(\"https://backendjt-1.onrender.com/getAllProducts\");\n        if (!response.ok) {\n          throw new Error(\"Failed to fetch products\");\n        }\n        \n        const data = await response.json();\n  \n        console.log(\"ðŸ“¦ Full API Response:\", data); // Debug full response\n  \n        setItems(data);\n        setFilteredItems(data);\n        const uniqueCategories = [...new Set(data.map((item) => item.category))];\n        setCategories(uniqueCategories);\n      } catch (error) {\n        console.error(\"Error fetching products:\", error);\n      }\n    };\n  \n    fetchProducts();\n  }, []);\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    const categoryFromUrl = queryParams.get(\"category\");\n\n    if (categoryFromUrl) {\n      setSelectedCategory(categoryFromUrl);\n      setFilteredItems(items.filter((item) => item.category === categoryFromUrl));\n    }\n  }, [location.search, items]);\n\n  const handleSortChange = (order) => {\n    setSortOrder(order);\n    setIsSortOpen(false);\n\n    // Always reset to all products before sorting\n    let sortedItems = [...items];\n\n    if (order === \"all\") {\n      setFilteredItems(sortedItems); // Reset to all products\n      return;\n    }\n\n    if (order === \"lowToHigh\") {\n      sortedItems.sort((a, b) => a.price - b.price);\n    } else if (order === \"highToLow\") {\n      sortedItems.sort((a, b) => b.price - a.price);\n    } else if (order === \"top5\") {\n      sortedItems = [...items]\n        .filter((item) => item.number !== undefined)\n        .sort((a, b) => (b.number || 0) - (a.number || 0))\n        .slice(0, 5);\n    }\n\n    setFilteredItems(sortedItems);\n  }\n\n  useEffect(() => {\n    if (sortOrder === \"top5\") {\n      handleSortChange(\"top5\");\n    }\n  }, [items, sortOrder, handleSortChange]);\n\n  const handleCategoryChange = (category) => {\n    setSelectedCategory(category);\n    setIsCategoryOpen(false);\n    setFilteredItems(category ? items.filter((item) => item.category === category) : items);\n    navigate(`/shop?category=${category}`);\n  };\n\n  const handleCartClick = () => {\n    const cartItems = JSON.parse(localStorage.getItem(\"cart\")) || [];\n    if (cartItems.length > 0) {\n      navigate(\"/cart\");\n    } else {\n      alert(\"Your cart is empty!\");\n    }\n  };\n\n  return (\n    <div className=\"shop\">\n      <div className=\"filter-container\">\n        <div className=\"custom-dropdown\">\n          <button className=\"dropdown-button\" onClick={() => setIsSortOpen(!isSortOpen)}>\n            {sortOrder\n              ? sortOrder === \"lowToHigh\"\n                ? \"Low to High\"\n                : sortOrder === \"highToLow\"\n                ? \"High to Low\"\n                : sortOrder === \"top5\"\n                ? \"Top 5 Ordered\"\n                : \"All Products\"\n              : \"Sort by\"}\n          </button>\n          {isSortOpen && (\n            <ul className=\"dropdown-menu\">\n              <li onClick={() => handleSortChange(\"all\")}>All Products</li>\n              <li onClick={() => handleSortChange(\"lowToHigh\")}>Low to High</li>\n              <li onClick={() => handleSortChange(\"highToLow\")}>High to Low</li>\n              <li onClick={() => handleSortChange(\"top5\")}>Top 5 Ordered</li>\n            </ul>\n          )}\n        </div>\n\n        <div className=\"custom-dropdown\">\n          <button className=\"dropdown-button\" onClick={() => setIsCategoryOpen(!isCategoryOpen)}>\n            {selectedCategory || \"Filter by Category\"}\n          </button>\n          {isCategoryOpen && (\n            <ul className=\"dropdown-menu\">\n              <li onClick={() => handleCategoryChange(\"\")}>All</li>\n              {categories.map((category) => (\n                <li key={category} onClick={() => handleCategoryChange(category)}>\n                  {category}\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n      </div>\n\n      <div className=\"product-grid\">\n        {filteredItems.length > 0 ? (\n          filteredItems.map((item) => <ProductCard key={item.id} product={item} />)\n        ) : (\n          <p>No products found</p>\n        )}\n      </div>\n\n      <div className=\"hiddenDiv\" onClick={handleCartClick}>\n        <i className=\"fas fa-shopping-cart\"></i>\n      </div>\n    </div>\n  );\n}\n\nexport default Shop;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}