{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useLocation}from'react-router-dom';import'../styles/Cart.css';import{Link}from'react-router-dom';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Cart(){const[cartItems,setCartItems]=useState(()=>{const savedCart=localStorage.getItem('cart');return savedCart?JSON.parse(savedCart):[];});const[discountCode,setDiscountCode]=useState('');const[discount,setDiscount]=useState(0);// Discount as a percentage\nconst[error,setError]=useState('');const location=useLocation();useEffect(()=>{var _location$state;const newItem=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.item;if(newItem){setCartItems(prevItems=>{const updatedCart=[...prevItems,newItem];localStorage.setItem('cart',JSON.stringify(updatedCart));return updatedCart;});window.history.replaceState({},document.title);}},[location.state]);const removeItemFromCart=index=>{setCartItems(prevItems=>{const updatedCart=prevItems.filter((_,i)=>i!==index);localStorage.setItem('cart',JSON.stringify(updatedCart));return updatedCart;});};const handleApplyDiscount=async()=>{try{const response=await axios.get(\"https://backendjt-1.onrender.com/discounts?discountCode=\".concat(discountCode));const discountData=response.data.discounts[0];// Assuming discount code is unique\nif(discountData){setDiscount(discountData.value);setError('');// Save the discount code and calculated discounted total in localStorage\nconst totalPrice=cartItems.reduce((total,item)=>{const price=parseFloat(item.price);return!isNaN(price)?total+price:total;},0);const discountedPrice=totalPrice-totalPrice*(discountData.value/100);localStorage.setItem('discountCode',discountCode);localStorage.setItem('discountedPrice',discountedPrice.toFixed(2));// Store the discounted price\n}else{setError('Invalid discount code');}}catch(error){console.error('Error verifying discount code:',error);setError('Error applying discount');}};const totalPrice=cartItems.reduce((total,item)=>{const price=parseFloat(item.price);return!isNaN(price)?total+price:total;},0);const discountedPrice=totalPrice-totalPrice*(discount/100);return/*#__PURE__*/_jsx(\"div\",{className:\"gills\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container1\",style:{height:\"auto\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Shopping Cart\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-table-header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Item\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"span\",{children:\" \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-table-body\",children:cartItems.length>0?cartItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"cart-table-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:item.name}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",item.price]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeItemFromCart(index),children:\"Remove\"})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Your cart is empty!\"})})]}),cartItems.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"discount-code\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter discount code\",value:discountCode,onChange:e=>setDiscountCode(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleApplyDiscount,children:\"Apply Discount\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error})]}),/*#__PURE__*/_jsx(\"div\",{className:\"total\",children:/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total: $\",discountedPrice.toFixed(2)]})})]}),/*#__PURE__*/_jsx(Link,{className:\"links\",to:\"/checkout\",onClick:()=>localStorage.setItem('checkoutCart',JSON.stringify(cartItems)),children:\"Check out\"})]})]})});}export default Cart;","map":{"version":3,"names":["React","useState","useEffect","useLocation","Link","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","cartItems","setCartItems","savedCart","localStorage","getItem","JSON","parse","discountCode","setDiscountCode","discount","setDiscount","error","setError","location","_location$state","newItem","state","item","prevItems","updatedCart","setItem","stringify","window","history","replaceState","document","title","removeItemFromCart","index","filter","_","i","handleApplyDiscount","response","get","concat","discountData","data","discounts","value","totalPrice","reduce","total","price","parseFloat","isNaN","discountedPrice","toFixed","console","className","children","style","height","length","map","name","onClick","type","placeholder","onChange","e","target","to"],"sources":["/Users/tasneemmahmud/Desktop/clientJT/src/components/Cart.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport '../styles/Cart.css';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\n\nfunction Cart() {\n  const [cartItems, setCartItems] = useState(() => {\n    const savedCart = localStorage.getItem('cart');\n    return savedCart ? JSON.parse(savedCart) : [];\n  });\n\n  const [discountCode, setDiscountCode] = useState('');\n  const [discount, setDiscount] = useState(0); // Discount as a percentage\n  const [error, setError] = useState('');\n\n  const location = useLocation();\n\n  useEffect(() => {\n    const newItem = location.state?.item;\n    if (newItem) {\n      setCartItems((prevItems) => {\n        const updatedCart = [...prevItems, newItem];\n        localStorage.setItem('cart', JSON.stringify(updatedCart));\n        return updatedCart;\n      });\n      window.history.replaceState({}, document.title);\n    }\n  }, [location.state]);\n\n  const removeItemFromCart = (index) => {\n    setCartItems((prevItems) => {\n      const updatedCart = prevItems.filter((_, i) => i !== index);\n      localStorage.setItem('cart', JSON.stringify(updatedCart));\n      return updatedCart;\n    });\n  };\n\n  const handleApplyDiscount = async () => {\n    try {\n      const response = await axios.get(`https://backendjt-1.onrender.com/discounts?discountCode=${discountCode}`);\n      const discountData = response.data.discounts[0]; // Assuming discount code is unique\n      if (discountData) {\n        setDiscount(discountData.value);\n        setError('');\n        // Save the discount code and calculated discounted total in localStorage\n        const totalPrice = cartItems.reduce((total, item) => {\n          const price = parseFloat(item.price);\n          return !isNaN(price) ? total + price : total;\n        }, 0);\n        const discountedPrice = totalPrice - (totalPrice * (discountData.value / 100));\n        localStorage.setItem('discountCode', discountCode);\n        localStorage.setItem('discountedPrice', discountedPrice.toFixed(2)); // Store the discounted price\n      } else {\n        setError('Invalid discount code');\n      }\n    } catch (error) {\n      console.error('Error verifying discount code:', error);\n      setError('Error applying discount');\n    }\n  };\n\n  const totalPrice = cartItems.reduce((total, item) => {\n    const price = parseFloat(item.price);\n    return !isNaN(price) ? total + price : total;\n  }, 0);\n\n  const discountedPrice = totalPrice - (totalPrice * (discount / 100));\n\n  return (\n    <div className=\"gills\">\n    <div className=\"container1\" style={{ height: \"auto\" }} >\n      <h1>Shopping Cart</h1>\n      <div className=\"cart\">\n        <div className=\"cart-table\">\n          <div className=\"cart-table-header\">\n            <span>Item</span>\n            <span>Price</span>\n            <span> </span>\n          </div>\n          <div className=\"cart-table-body\">\n            {cartItems.length > 0 ? (\n              cartItems.map((item, index) => (\n                <div key={index} className=\"cart-table-row\">\n                  <span>{item.name}</span>\n                  <span>${item.price}</span>\n                  <button onClick={() => removeItemFromCart(index)}>Remove</button>\n                </div>\n              ))\n            ) : (\n              <p>Your cart is empty!</p>\n            )}\n          </div>\n        </div>\n        {cartItems.length > 0 && (\n          <>\n            <div className=\"discount-code\">\n              <input\n                type=\"text\"\n                placeholder=\"Enter discount code\"\n                value={discountCode}\n                onChange={(e) => setDiscountCode(e.target.value)}\n              />\n              <button onClick={handleApplyDiscount}>Apply Discount</button>\n              {error && <p className=\"error\">{error}</p>}\n            </div>\n            <div className=\"total\">\n              <h3>Total: ${discountedPrice.toFixed(2)}</h3>\n            </div>\n          </>\n        )}\n        <Link className=\"links\" to=\"/checkout\" onClick={() => localStorage.setItem('checkoutCart', JSON.stringify(cartItems))}>\n          Check out\n        </Link>\n      </div>\n    </div>\n    </div>\n  );\n}\n\nexport default Cart;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,oBAAoB,CAC3B,OAASC,IAAI,KAAQ,kBAAkB,CACvC,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1B,QAAS,CAAAC,IAAIA,CAAA,CAAG,CACd,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,IAAM,CAC/C,KAAM,CAAAc,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC9C,MAAO,CAAAF,SAAS,CAAGG,IAAI,CAACC,KAAK,CAACJ,SAAS,CAAC,CAAG,EAAE,CAC/C,CAAC,CAAC,CAEF,KAAM,CAACK,YAAY,CAAEC,eAAe,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACqB,QAAQ,CAAEC,WAAW,CAAC,CAAGtB,QAAQ,CAAC,CAAC,CAAC,CAAE;AAC7C,KAAM,CAACuB,KAAK,CAAEC,QAAQ,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CAEtC,KAAM,CAAAyB,QAAQ,CAAGvB,WAAW,CAAC,CAAC,CAE9BD,SAAS,CAAC,IAAM,KAAAyB,eAAA,CACd,KAAM,CAAAC,OAAO,EAAAD,eAAA,CAAGD,QAAQ,CAACG,KAAK,UAAAF,eAAA,iBAAdA,eAAA,CAAgBG,IAAI,CACpC,GAAIF,OAAO,CAAE,CACXd,YAAY,CAAEiB,SAAS,EAAK,CAC1B,KAAM,CAAAC,WAAW,CAAG,CAAC,GAAGD,SAAS,CAAEH,OAAO,CAAC,CAC3CZ,YAAY,CAACiB,OAAO,CAAC,MAAM,CAAEf,IAAI,CAACgB,SAAS,CAACF,WAAW,CAAC,CAAC,CACzD,MAAO,CAAAA,WAAW,CACpB,CAAC,CAAC,CACFG,MAAM,CAACC,OAAO,CAACC,YAAY,CAAC,CAAC,CAAC,CAAEC,QAAQ,CAACC,KAAK,CAAC,CACjD,CACF,CAAC,CAAE,CAACb,QAAQ,CAACG,KAAK,CAAC,CAAC,CAEpB,KAAM,CAAAW,kBAAkB,CAAIC,KAAK,EAAK,CACpC3B,YAAY,CAAEiB,SAAS,EAAK,CAC1B,KAAM,CAAAC,WAAW,CAAGD,SAAS,CAACW,MAAM,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKA,CAAC,GAAKH,KAAK,CAAC,CAC3DzB,YAAY,CAACiB,OAAO,CAAC,MAAM,CAAEf,IAAI,CAACgB,SAAS,CAACF,WAAW,CAAC,CAAC,CACzD,MAAO,CAAAA,WAAW,CACpB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAa,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAzC,KAAK,CAAC0C,GAAG,4DAAAC,MAAA,CAA4D5B,YAAY,CAAE,CAAC,CAC3G,KAAM,CAAA6B,YAAY,CAAGH,QAAQ,CAACI,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC,CAAE;AACjD,GAAIF,YAAY,CAAE,CAChB1B,WAAW,CAAC0B,YAAY,CAACG,KAAK,CAAC,CAC/B3B,QAAQ,CAAC,EAAE,CAAC,CACZ;AACA,KAAM,CAAA4B,UAAU,CAAGxC,SAAS,CAACyC,MAAM,CAAC,CAACC,KAAK,CAAEzB,IAAI,GAAK,CACnD,KAAM,CAAA0B,KAAK,CAAGC,UAAU,CAAC3B,IAAI,CAAC0B,KAAK,CAAC,CACpC,MAAO,CAACE,KAAK,CAACF,KAAK,CAAC,CAAGD,KAAK,CAAGC,KAAK,CAAGD,KAAK,CAC9C,CAAC,CAAE,CAAC,CAAC,CACL,KAAM,CAAAI,eAAe,CAAGN,UAAU,CAAIA,UAAU,EAAIJ,YAAY,CAACG,KAAK,CAAG,GAAG,CAAE,CAC9EpC,YAAY,CAACiB,OAAO,CAAC,cAAc,CAAEb,YAAY,CAAC,CAClDJ,YAAY,CAACiB,OAAO,CAAC,iBAAiB,CAAE0B,eAAe,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAE;AACvE,CAAC,IAAM,CACLnC,QAAQ,CAAC,uBAAuB,CAAC,CACnC,CACF,CAAE,MAAOD,KAAK,CAAE,CACdqC,OAAO,CAACrC,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtDC,QAAQ,CAAC,yBAAyB,CAAC,CACrC,CACF,CAAC,CAED,KAAM,CAAA4B,UAAU,CAAGxC,SAAS,CAACyC,MAAM,CAAC,CAACC,KAAK,CAAEzB,IAAI,GAAK,CACnD,KAAM,CAAA0B,KAAK,CAAGC,UAAU,CAAC3B,IAAI,CAAC0B,KAAK,CAAC,CACpC,MAAO,CAACE,KAAK,CAACF,KAAK,CAAC,CAAGD,KAAK,CAAGC,KAAK,CAAGD,KAAK,CAC9C,CAAC,CAAE,CAAC,CAAC,CAEL,KAAM,CAAAI,eAAe,CAAGN,UAAU,CAAIA,UAAU,EAAI/B,QAAQ,CAAG,GAAG,CAAE,CAEpE,mBACEf,IAAA,QAAKuD,SAAS,CAAC,OAAO,CAAAC,QAAA,cACtBtD,KAAA,QAAKqD,SAAS,CAAC,YAAY,CAACE,KAAK,CAAE,CAAEC,MAAM,CAAE,MAAO,CAAE,CAAAF,QAAA,eACpDxD,IAAA,OAAAwD,QAAA,CAAI,eAAa,CAAI,CAAC,cACtBtD,KAAA,QAAKqD,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBtD,KAAA,QAAKqD,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBtD,KAAA,QAAKqD,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCxD,IAAA,SAAAwD,QAAA,CAAM,MAAI,CAAM,CAAC,cACjBxD,IAAA,SAAAwD,QAAA,CAAM,OAAK,CAAM,CAAC,cAClBxD,IAAA,SAAAwD,QAAA,CAAM,GAAC,CAAM,CAAC,EACX,CAAC,cACNxD,IAAA,QAAKuD,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAC7BlD,SAAS,CAACqD,MAAM,CAAG,CAAC,CACnBrD,SAAS,CAACsD,GAAG,CAAC,CAACrC,IAAI,CAAEW,KAAK,gBACxBhC,KAAA,QAAiBqD,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eACzCxD,IAAA,SAAAwD,QAAA,CAAOjC,IAAI,CAACsC,IAAI,CAAO,CAAC,cACxB3D,KAAA,SAAAsD,QAAA,EAAM,GAAC,CAACjC,IAAI,CAAC0B,KAAK,EAAO,CAAC,cAC1BjD,IAAA,WAAQ8D,OAAO,CAAEA,CAAA,GAAM7B,kBAAkB,CAACC,KAAK,CAAE,CAAAsB,QAAA,CAAC,QAAM,CAAQ,CAAC,GAHzDtB,KAIL,CACN,CAAC,cAEFlC,IAAA,MAAAwD,QAAA,CAAG,qBAAmB,CAAG,CAC1B,CACE,CAAC,EACH,CAAC,CACLlD,SAAS,CAACqD,MAAM,CAAG,CAAC,eACnBzD,KAAA,CAAAE,SAAA,EAAAoD,QAAA,eACEtD,KAAA,QAAKqD,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BxD,IAAA,UACE+D,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,qBAAqB,CACjCnB,KAAK,CAAEhC,YAAa,CACpBoD,QAAQ,CAAGC,CAAC,EAAKpD,eAAe,CAACoD,CAAC,CAACC,MAAM,CAACtB,KAAK,CAAE,CAClD,CAAC,cACF7C,IAAA,WAAQ8D,OAAO,CAAExB,mBAAoB,CAAAkB,QAAA,CAAC,gBAAc,CAAQ,CAAC,CAC5DvC,KAAK,eAAIjB,IAAA,MAAGuD,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEvC,KAAK,CAAI,CAAC,EACvC,CAAC,cACNjB,IAAA,QAAKuD,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpBtD,KAAA,OAAAsD,QAAA,EAAI,UAAQ,CAACJ,eAAe,CAACC,OAAO,CAAC,CAAC,CAAC,EAAK,CAAC,CAC1C,CAAC,EACN,CACH,cACDrD,IAAA,CAACH,IAAI,EAAC0D,SAAS,CAAC,OAAO,CAACa,EAAE,CAAC,WAAW,CAACN,OAAO,CAAEA,CAAA,GAAMrD,YAAY,CAACiB,OAAO,CAAC,cAAc,CAAEf,IAAI,CAACgB,SAAS,CAACrB,SAAS,CAAC,CAAE,CAAAkD,QAAA,CAAC,WAEvH,CAAM,CAAC,EACJ,CAAC,EACH,CAAC,CACD,CAAC,CAEV,CAEA,cAAe,CAAAnD,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}